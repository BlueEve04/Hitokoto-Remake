<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/blueeve/hitokoto/FavoriteAdapter.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/blueeve/hitokoto/FavoriteAdapter.java" />
              <option name="originalContent" value="package com.blueeve.hitokoto;&#10;&#10;import android.app.AlertDialog;&#10;import android.content.Context;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.TextView;&#10;import androidx.annotation.NonNull;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import org.json.JSONObject;&#10;import java.util.List;&#10;&#10;public class FavoriteAdapter extends RecyclerView.Adapter&lt;FavoriteAdapter.ViewHolder&gt; {&#10;    private List&lt;JSONObject&gt; data;&#10;    private Context context;&#10;    public FavoriteAdapter(Context context, List&lt;JSONObject&gt; data) {&#10;        this.context = context;&#10;        this.data = data;&#10;    }&#10;    @NonNull&#10;    @Override&#10;    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {&#10;        View view = LayoutInflater.from(context).inflate(R.layout.item_favorite, parent, false);&#10;        return new ViewHolder(view);&#10;    }&#10;    @Override&#10;    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {&#10;        JSONObject obj = data.get(position);&#10;        holder.tvIndex.setText(String.valueOf(position + 1));&#10;        holder.tvContent.setText(obj.optString(&quot;hitokoto&quot;, &quot;&quot;));&#10;        holder.tvContent.setSelected(true); // 跑马灯&#10;        String author = obj.optString(&quot;from_who&quot;, &quot;&quot;)==&quot;null&quot;?&quot;未知作者&quot;:obj.optString(&quot;from_who&quot;, &quot;&quot;);&#10;        if (author.isEmpty()) author = obj.optString(&quot;creator&quot;, &quot;&quot;)==&quot;null&quot;?&quot;未知来源&quot;:obj.optString(&quot;creator&quot;, &quot;&quot;);&#10;        holder.tvAuthor.setText(author);&#10;        holder.itemView.setOnClickListener(v -&gt; {&#10;            StringBuilder msg = new StringBuilder();&#10;            msg.append(obj.optString(&quot;hitokoto&quot;, &quot;&quot;));&#10;            String from = obj.optString(&quot;from&quot;, &quot;&quot;)==&quot;null&quot;?&quot;未知出处&quot;:obj.optString(&quot;from&quot;, &quot;&quot;);&#10;            String fromWho = obj.optString(&quot;from_who&quot;, &quot;&quot;==&quot;null&quot;?&quot;未知作者&quot;:obj.optString(&quot;from_who&quot;, &quot;&quot;));&#10;            String creator = obj.optString(&quot;creator&quot;, &quot;&quot;)==&quot;null&quot;?&quot;未知来源&quot;:obj.optString(&quot;creator&quot;, &quot;&quot;);&#10;            if (!from.isEmpty()) msg.append(&quot;\n—— &quot;).append(from);&#10;            if (!fromWho.isEmpty()) msg.append(&quot;  &quot;).append(fromWho);&#10;            if (!creator.isEmpty()) msg.append(&quot;\n录入者: &quot;).append(creator);&#10;            String content = msg.toString();&#10;            new AlertDialog.Builder(context)&#10;                .setTitle(&quot;收藏详情&quot;)&#10;                .setMessage(content)&#10;                .setPositiveButton(&quot;复制&quot;, (dialog, which) -&gt; ClipboardUtil.copy(context, content))&#10;                .setNegativeButton(&quot;关闭&quot;, null)&#10;                .show();&#10;        });&#10;    }&#10;    @Override&#10;    public int getItemCount() {&#10;        return data.size();&#10;    }&#10;    public static class ViewHolder extends RecyclerView.ViewHolder {&#10;        TextView tvIndex, tvContent, tvAuthor;&#10;        public ViewHolder(@NonNull View itemView) {&#10;            super(itemView);&#10;            tvIndex = itemView.findViewById(R.id.tvIndex);&#10;            tvContent = itemView.findViewById(R.id.tvContent);&#10;            tvAuthor = itemView.findViewById(R.id.tvAuthor);&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.blueeve.hitokoto;&#13;&#10;&#13;&#10;import android.app.AlertDialog;&#13;&#10;import android.content.Context;&#13;&#10;import android.view.LayoutInflater;&#13;&#10;import android.view.View;&#13;&#10;import android.view.ViewGroup;&#13;&#10;import android.widget.TextView;&#13;&#10;import androidx.annotation.NonNull;&#13;&#10;import androidx.recyclerview.widget.RecyclerView;&#13;&#10;import org.json.JSONObject;&#13;&#10;import java.util.List;&#13;&#10;&#13;&#10;public class FavoriteAdapter extends RecyclerView.Adapter&lt;FavoriteAdapter.ViewHolder&gt; {&#13;&#10;    private List&lt;JSONObject&gt; data;&#13;&#10;    private Context context;&#13;&#10;    public FavoriteAdapter(Context context, List&lt;JSONObject&gt; data) {&#13;&#10;        this.context = context;&#13;&#10;        this.data = data;&#13;&#10;    }&#13;&#10;    @NonNull&#13;&#10;    @Override&#13;&#10;    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {&#13;&#10;        View view = LayoutInflater.from(context).inflate(R.layout.item_favorite, parent, false);&#13;&#10;        return new ViewHolder(view);&#13;&#10;    }&#13;&#10;    @Override&#13;&#10;    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {&#13;&#10;        JSONObject obj = data.get(position);&#13;&#10;        holder.tvIndex.setText(String.valueOf(position + 1));&#13;&#10;        String hitokoto = obj.optString(&quot;hitokoto&quot;, &quot;&quot;);&#13;&#10;        String from = obj.optString(&quot;from&quot;, &quot;&quot;).equals(&quot;null&quot;) ? &quot;未知来源&quot; : obj.optString(&quot;from&quot;, &quot;&quot;);&#13;&#10;        String fromWho = obj.optString(&quot;from_who&quot;, &quot;&quot;).equals(&quot;null&quot;) ? &quot;未知作者&quot; : obj.optString(&quot;from_who&quot;, &quot;&quot;);&#13;&#10;        String creator = obj.optString(&quot;creator&quot;, &quot;&quot;).equals(&quot;null&quot;) ? &quot;未知&quot; : obj.optString(&quot;creator&quot;, &quot;&quot;);&#13;&#10;        String author = fromWho.isEmpty() ? (creator.isEmpty() ? &quot;&quot; : creator) : fromWho;&#13;&#10;        holder.tvContent.setText(hitokoto);&#13;&#10;        holder.tvContent.setSelected(true); // 跑马灯&#13;&#10;        holder.tvAuthor.setText(author);&#13;&#10;        holder.itemView.setOnClickListener(v -&gt; {&#13;&#10;            StringBuilder msg = new StringBuilder();&#13;&#10;            msg.append(hitokoto);&#13;&#10;            if (!from.isEmpty()) msg.append(&quot;\n—— &quot;).append(from);&#13;&#10;            if (!fromWho.isEmpty()) msg.append(&quot;  &quot;).append(fromWho);&#13;&#10;            if (!creator.isEmpty()) msg.append(&quot;\n录入者: &quot;).append(creator);&#13;&#10;            String content = msg.toString();&#13;&#10;            new AlertDialog.Builder(context)&#13;&#10;                .setTitle(&quot;收藏详情&quot;)&#13;&#10;                .setMessage(content)&#13;&#10;                .setPositiveButton(&quot;复制&quot;, (dialog, which) -&gt; ClipboardUtil.copy(context, content))&#13;&#10;                .setNegativeButton(&quot;关闭&quot;, null)&#13;&#10;                .show();&#13;&#10;        });&#13;&#10;    }&#13;&#10;    @Override&#13;&#10;    public int getItemCount() {&#13;&#10;        return data.size();&#13;&#10;    }&#13;&#10;    public static class ViewHolder extends RecyclerView.ViewHolder {&#13;&#10;        TextView tvIndex, tvContent, tvAuthor;&#13;&#10;        public ViewHolder(@NonNull View itemView) {&#13;&#10;            super(itemView);&#13;&#10;            tvIndex = itemView.findViewById(R.id.tvIndex);&#13;&#10;            tvContent = itemView.findViewById(R.id.tvContent);&#13;&#10;            tvAuthor = itemView.findViewById(R.id.tvAuthor);&#13;&#10;        }&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/blueeve/hitokoto/WidgetConfigActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/blueeve/hitokoto/WidgetConfigActivity.java" />
              <option name="originalContent" value="package com.blueeve.hitokoto;&#10;&#10;import android.app.Activity;&#10;import android.appwidget.AppWidgetManager;&#10;import android.content.Context;&#10;import android.content.Intent;&#10;import android.content.SharedPreferences;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.ArrayAdapter;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.Spinner;&#10;import android.widget.Switch;&#10;import java.io.IOException;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class WidgetConfigActivity extends Activity {&#10;    private int appWidgetId = AppWidgetManager.INVALID_APPWIDGET_ID;&#10;    private EditText etMaxLines;&#10;    private Spinner spinnerFont, spinnerBg, spinnerFontColor, spinnerFromColor, spinnerRefreshInterval;&#10;    private Button btnSave;&#10;    private Switch switchShowFrom, switchShowAuthor;&#10;    private static final String PREFS_NAME = &quot;widget_prefs&quot;;&#10;    private static final String[] BG_OPTIONS = {&quot;白色&quot;, &quot;黑色&quot;, &quot;跟随系统&quot;, &quot;透明&quot;,&quot;黄纸本&quot;};&#10;    private static final String[] FONT_COLOR_OPTIONS = {&quot;黑色&quot;, &quot;白色&quot;, &quot;跟随系统&quot;};&#10;    private static final String[] FROM_COLOR_OPTIONS = {&quot;灰色&quot;, &quot;白色&quot;, &quot;黑色&quot;};&#10;    private static final String[] REFRESH_INTERVAL_OPTIONS = {&quot;15分钟&quot;, &quot;30分钟&quot;, &quot;1小时&quot;, &quot;2小时&quot;, &quot;5小时&quot;, &quot;12小时&quot;, &quot;24小时&quot;, &quot;永不自动刷新&quot;};&#10;    private static final long[] REFRESH_INTERVAL_VALUES = {15*60*1000L, 30*60*1000L, 60*60*1000L, 2*60*60*1000L, 5*60*60*1000L, 12*60*60*1000L, 24*60*60*1000L, 0L};&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.widget_config);&#10;        etMaxLines = findViewById(R.id.et_max_lines);&#10;        spinnerFont = findViewById(R.id.spinner_font);&#10;        spinnerBg = findViewById(R.id.spinner_bg);&#10;        spinnerFontColor = findViewById(R.id.spinner_font_color);&#10;        spinnerFromColor = findViewById(R.id.spinner_from_color);&#10;        spinnerRefreshInterval = findViewById(R.id.spinner_refresh_interval);&#10;        btnSave = findViewById(R.id.btn_save);&#10;        switchShowFrom = findViewById(R.id.switch_show_from);&#10;        switchShowAuthor = findViewById(R.id.switch_show_author);&#10;&#10;        // 获取 appWidgetId&#10;        Intent intent = getIntent();&#10;        Bundle extras = intent.getExtras();&#10;        if (extras != null) {&#10;            appWidgetId = extras.getInt(AppWidgetManager.EXTRA_APPWIDGET_ID, AppWidgetManager.INVALID_APPWIDGET_ID);&#10;        }&#10;        if (appWidgetId == AppWidgetManager.INVALID_APPWIDGET_ID) {&#10;            // 允许无 appWidgetId 进入全局设置模式&#10;            appWidgetId = -1;&#10;        }&#10;&#10;        // 字体选择&#10;        List&lt;String&gt; fontList = new ArrayList&lt;&gt;();&#10;        fontList.add(&quot;系统默认&quot;);&#10;        try {&#10;            String[] fonts = getAssets().list(&quot;&quot;);&#10;            if (fonts != null) {&#10;                for (String f : fonts) {&#10;                    if (f.endsWith(&quot;.ttf&quot;) || f.endsWith(&quot;.otf&quot;)) fontList.add(f);&#10;                }&#10;            }&#10;        } catch (IOException ignored) {}&#10;        // 字体选择（支持自定义目录）&#10;        java.io.File customFontDir = new java.io.File(&quot;/storage/emulated/0/HitokotoFonts/&quot;);&#10;        if (customFontDir.exists() &amp;&amp; customFontDir.isDirectory()) {&#10;            java.io.File[] files = customFontDir.listFiles();&#10;            if (files != null) {&#10;                for (java.io.File f : files) {&#10;                    if (f.getName().endsWith(&quot;.ttf&quot;) || f.getName().endsWith(&quot;.otf&quot;)) {&#10;                        fontList.add(&quot;[自定义]&quot; + f.getName());&#10;                    }&#10;                }&#10;            }&#10;        }&#10;        ArrayAdapter&lt;String&gt; fontAdapter = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item, fontList);&#10;        fontAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerFont.setAdapter(fontAdapter);&#10;&#10;        // 背景色选择&#10;        ArrayAdapter&lt;String&gt; bgAdapter = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item, BG_OPTIONS);&#10;        bgAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerBg.setAdapter(bgAdapter);&#10;        // 字体颜色选择&#10;        ArrayAdapter&lt;String&gt; fontColorAdapter = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item, FONT_COLOR_OPTIONS);&#10;        fontColorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerFontColor.setAdapter(fontColorAdapter);&#10;        // 来源字体颜色选择&#10;        ArrayAdapter&lt;String&gt; fromColorAdapter = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item, FROM_COLOR_OPTIONS);&#10;        fromColorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerFromColor.setAdapter(fromColorAdapter);&#10;        // 刷新间隔选择&#10;        ArrayAdapter&lt;String&gt; refreshIntervalAdapter = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item, REFRESH_INTERVAL_OPTIONS);&#10;        refreshIntervalAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerRefreshInterval.setAdapter(refreshIntervalAdapter);&#10;&#10;        btnSave.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                saveConfig();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void saveConfig() {&#10;        int maxLines = 4;&#10;        try {&#10;            maxLines = Integer.parseInt(etMaxLines.getText().toString());&#10;        } catch (Exception ignored) {}&#10;        String font = spinnerFont.getSelectedItem().toString();&#10;        String bg = spinnerBg.getSelectedItem().toString();&#10;        String fontColor = spinnerFontColor.getSelectedItem().toString();&#10;        boolean showFrom = switchShowFrom.isChecked();&#10;        String fromColor = spinnerFromColor.getSelectedItem().toString();&#10;        boolean showAuthor = switchShowAuthor.isChecked();&#10;        int refreshIntervalIndex = spinnerRefreshInterval.getSelectedItemPosition();&#10;        long refreshIntervalValue = REFRESH_INTERVAL_VALUES[refreshIntervalIndex];&#10;        SharedPreferences prefs = getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE);&#10;        SharedPreferences.Editor editor = prefs.edit();&#10;        if (appWidgetId == -1) {&#10;            editor.putInt(&quot;maxLines_global&quot;, maxLines);&#10;            editor.putString(&quot;font_global&quot;, font);&#10;            editor.putString(&quot;bg_global&quot;, bg);&#10;            editor.putString(&quot;fontColor_global&quot;, fontColor);&#10;            editor.putBoolean(&quot;showFrom_global&quot;, showFrom);&#10;            editor.putString(&quot;fromColor_global&quot;, fromColor);&#10;            editor.putBoolean(&quot;showAuthor_global&quot;, showAuthor);&#10;            editor.putLong(&quot;refreshInterval_global&quot;, refreshIntervalValue);&#10;            editor.apply();&#10;            android.widget.Toast.makeText(this, &quot;全局设置已保存&quot;, android.widget.Toast.LENGTH_SHORT).show();&#10;        } else {&#10;            editor.putInt(&quot;maxLines_&quot; + appWidgetId, maxLines);&#10;            editor.putString(&quot;font_&quot; + appWidgetId, font);&#10;            editor.putString(&quot;bg_&quot; + appWidgetId, bg);&#10;            editor.putString(&quot;fontColor_&quot; + appWidgetId, fontColor);&#10;            editor.putBoolean(&quot;showFrom_&quot; + appWidgetId, showFrom);&#10;            editor.putString(&quot;fromColor_&quot; + appWidgetId, fromColor);&#10;            editor.putBoolean(&quot;showAuthor_&quot; + appWidgetId, showAuthor);&#10;            editor.putLong(&quot;refreshInterval_&quot; + appWidgetId, refreshIntervalValue);&#10;            editor.apply();&#10;            // 刷新小部件&#10;            AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(this);&#10;            HitokotoWidgetProvider.updateAppWidget(this, appWidgetManager, appWidgetId);&#10;            // 返回结果&#10;            Intent resultValue = new Intent();&#10;            resultValue.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId);&#10;            setResult(RESULT_OK, resultValue);&#10;            finish();&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.blueeve.hitokoto;&#10;&#10;import android.app.Activity;&#10;import android.appwidget.AppWidgetManager;&#10;import android.content.Context;&#10;import android.content.Intent;&#10;import android.content.SharedPreferences;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.ArrayAdapter;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.Spinner;&#10;import android.widget.Switch;&#10;import java.io.IOException;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class WidgetConfigActivity extends Activity {&#10;    private int appWidgetId = AppWidgetManager.INVALID_APPWIDGET_ID;&#10;    private EditText etMaxLines;&#10;    private Spinner spinnerFont, spinnerBg, spinnerFontColor, spinnerFromColor, spinnerRefreshInterval;&#10;    private Button btnSave;&#10;    private Switch switchShowFrom, switchShowAuthor;&#10;    private static final String PREFS_NAME = &quot;widget_prefs&quot;;&#10;    private static final String[] BG_OPTIONS = {&quot;白色&quot;, &quot;黑色&quot;, &quot;跟随系统&quot;, &quot;透明&quot;,&quot;黄纸本&quot;};&#10;    private static final String[] FONT_COLOR_OPTIONS = {&quot;黑色&quot;, &quot;白色&quot;, &quot;跟随系统&quot;};&#10;    private static final String[] FROM_COLOR_OPTIONS = {&quot;灰色&quot;, &quot;白色&quot;, &quot;黑色&quot;};&#10;    private static final String[] REFRESH_INTERVAL_OPTIONS = {&quot;15分钟&quot;, &quot;30分钟&quot;, &quot;1小时&quot;, &quot;2小时&quot;, &quot;5小时&quot;, &quot;12小时&quot;, &quot;24小时&quot;, &quot;永不自动刷新&quot;};&#10;    private static final long[] REFRESH_INTERVAL_VALUES = {15*60*1000L, 30*60*1000L, 60*60*1000L, 2*60*60*1000L, 5*60*60*1000L, 12*60*60*1000L, 24*60*60*1000L, 0L};&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.widget_config);&#10;        etMaxLines = findViewById(R.id.et_max_lines);&#10;        spinnerFont = findViewById(R.id.spinner_font);&#10;        spinnerBg = findViewById(R.id.spinner_bg);&#10;        spinnerFontColor = findViewById(R.id.spinner_font_color);&#10;        spinnerFromColor = findViewById(R.id.spinner_from_color);&#10;        spinnerRefreshInterval = findViewById(R.id.spinner_refresh_interval);&#10;        btnSave = findViewById(R.id.btn_save);&#10;        switchShowFrom = findViewById(R.id.switch_show_from);&#10;        switchShowAuthor = findViewById(R.id.switch_show_author);&#10;&#10;        // 获取 appWidgetId&#10;        Intent intent = getIntent();&#10;        Bundle extras = intent.getExtras();&#10;        if (extras != null) {&#10;            appWidgetId = extras.getInt(AppWidgetManager.EXTRA_APPWIDGET_ID, AppWidgetManager.INVALID_APPWIDGET_ID);&#10;        }&#10;        if (appWidgetId == AppWidgetManager.INVALID_APPWIDGET_ID) {&#10;            // 允许无 appWidgetId 进入全局设置模式&#10;            appWidgetId = -1;&#10;        }&#10;&#10;        // 字体选择&#10;        List&lt;String&gt; fontList = new ArrayList&lt;&gt;();&#10;        fontList.add(&quot;系统默认&quot;);&#10;        try {&#10;            String[] fonts = getAssets().list(&quot;&quot;);&#10;            if (fonts != null) {&#10;                for (String f : fonts) {&#10;                    if (f.endsWith(&quot;.ttf&quot;) || f.endsWith(&quot;.otf&quot;)) fontList.add(f);&#10;                }&#10;            }&#10;        } catch (IOException ignored) {}&#10;        // 字体选择（支持自定义目录）&#10;        java.io.File customFontDir = new java.io.File(&quot;/storage/emulated/0/HitokotoFonts/&quot;);&#10;        if (customFontDir.exists() &amp;&amp; customFontDir.isDirectory()) {&#10;            java.io.File[] files = customFontDir.listFiles();&#10;            if (files != null) {&#10;                for (java.io.File f : files) {&#10;                    if (f.getName().endsWith(&quot;.ttf&quot;) || f.getName().endsWith(&quot;.otf&quot;)) {&#10;                        fontList.add(&quot;[自定义]&quot; + f.getName());&#10;                    }&#10;                }&#10;            }&#10;        }&#10;        ArrayAdapter&lt;String&gt; fontAdapter = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item, fontList);&#10;        fontAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerFont.setAdapter(fontAdapter);&#10;&#10;        // 背景色选择&#10;        ArrayAdapter&lt;String&gt; bgAdapter = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item, BG_OPTIONS);&#10;        bgAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerBg.setAdapter(bgAdapter);&#10;        // 字体颜色选择&#10;        ArrayAdapter&lt;String&gt; fontColorAdapter = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item, FONT_COLOR_OPTIONS);&#10;        fontColorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerFontColor.setAdapter(fontColorAdapter);&#10;        // 来源字体颜色选择&#10;        ArrayAdapter&lt;String&gt; fromColorAdapter = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item, FROM_COLOR_OPTIONS);&#10;        fromColorAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerFromColor.setAdapter(fromColorAdapter);&#10;        // 刷新间隔选择&#10;        ArrayAdapter&lt;String&gt; refreshIntervalAdapter = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item, REFRESH_INTERVAL_OPTIONS);&#10;        refreshIntervalAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerRefreshInterval.setAdapter(refreshIntervalAdapter);&#10;&#10;        btnSave.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                saveConfig();&#10;            }&#10;        });&#10;        // 设置窗口宽度为屏幕宽度的90%&#10;        android.view.WindowManager.LayoutParams params = getWindow().getAttributes();&#10;        android.util.DisplayMetrics dm = getResources().getDisplayMetrics();&#10;        params.width = (int) (dm.widthPixels * 0.9);&#10;        getWindow().setAttributes(params);&#10;    }&#10;&#10;    private void saveConfig() {&#10;        int maxLines = 4;&#10;        try {&#10;            maxLines = Integer.parseInt(etMaxLines.getText().toString());&#10;        } catch (Exception ignored) {}&#10;        String font = spinnerFont.getSelectedItem().toString();&#10;        String bg = spinnerBg.getSelectedItem().toString();&#10;        String fontColor = spinnerFontColor.getSelectedItem().toString();&#10;        boolean showFrom = switchShowFrom.isChecked();&#10;        String fromColor = spinnerFromColor.getSelectedItem().toString();&#10;        boolean showAuthor = switchShowAuthor.isChecked();&#10;        int refreshIntervalIndex = spinnerRefreshInterval.getSelectedItemPosition();&#10;        long refreshIntervalValue = REFRESH_INTERVAL_VALUES[refreshIntervalIndex];&#10;        SharedPreferences prefs = getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE);&#10;        SharedPreferences.Editor editor = prefs.edit();&#10;        if (appWidgetId == -1) {&#10;            editor.putInt(&quot;maxLines_global&quot;, maxLines);&#10;            editor.putString(&quot;font_global&quot;, font);&#10;            editor.putString(&quot;bg_global&quot;, bg);&#10;            editor.putString(&quot;fontColor_global&quot;, fontColor);&#10;            editor.putBoolean(&quot;showFrom_global&quot;, showFrom);&#10;            editor.putString(&quot;fromColor_global&quot;, fromColor);&#10;            editor.putBoolean(&quot;showAuthor_global&quot;, showAuthor);&#10;            editor.putLong(&quot;refreshInterval_global&quot;, refreshIntervalValue);&#10;            editor.apply();&#10;            android.widget.Toast.makeText(this, &quot;全局设置已保存&quot;, android.widget.Toast.LENGTH_SHORT).show();&#10;        } else {&#10;            editor.putInt(&quot;maxLines_&quot; + appWidgetId, maxLines);&#10;            editor.putString(&quot;font_&quot; + appWidgetId, font);&#10;            editor.putString(&quot;bg_&quot; + appWidgetId, bg);&#10;            editor.putString(&quot;fontColor_&quot; + appWidgetId, fontColor);&#10;            editor.putBoolean(&quot;showFrom_&quot; + appWidgetId, showFrom);&#10;            editor.putString(&quot;fromColor_&quot; + appWidgetId, fromColor);&#10;            editor.putBoolean(&quot;showAuthor_&quot; + appWidgetId, showAuthor);&#10;            editor.putLong(&quot;refreshInterval_&quot; + appWidgetId, refreshIntervalValue);&#10;            editor.apply();&#10;            // 刷新小部件&#10;            AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(this);&#10;            HitokotoWidgetProvider.updateAppWidget(this, appWidgetManager, appWidgetId);&#10;            // 返回结果&#10;            Intent resultValue = new Intent();&#10;            resultValue.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId);&#10;            setResult(RESULT_OK, resultValue);&#10;            finish();&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>